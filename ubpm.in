#!@UBPM_BASH_SHEBANG@

SOURCE="${BASH_SOURCE[0]}"
while [ -h "${SOURCE}" ]; do
  DIR="$(cd -P "$(dirname "${SOURCE}")" >/dev/null 2>&1 && pwd)"
  SOURCE="$(readlink "${SOURCE}")"
  [[ "${SOURCE}" != "/*" ]] && SOURCE="${DIR}/${SOURCE}"
done
DIR="$(cd -P "$(dirname "${SOURCE}")" >/dev/null 2>&1 && pwd)"

MODULE_DIR="$(cd "${DIR}/@UBPM_BIN_MODULE_PATH@"; pwd -P)"
MODULE_PATH="${MODULE_DIR}/ubpm.cmake"

if [ ! -f "${MODULE_PATH}" ]; then
  printf "No such file:\n%s\n" "${MODULE_PATH}" >&2
  exit 1
fi

if [ "${UBPM_MODULE_PATH}" != "${MODULE_PATH}" ]; then
  echo "/!\\ The UBPM_MODULE_PATH env variable is not set to ubpm.cmake"
  echo "/!\\ Please set it to the following path:"
  printf "%s\n\n" "$MODULE_PATH"
fi

printf "%s\n" "${MODULE_PATH}"
